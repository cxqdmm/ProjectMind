## 现状与原因
- 项目已有后端记忆管理路由：`GET /api/memories/list`、`POST /api/memories/deprecate` 等（见 [memories.js](file:///Users/mac/Documents/cxq/工作/ProjectMind/server/routes/memories.js)），但：
  - `list` 只返回“非 deprecated 的 memory 内容”，**不带文件名/ID**，前端无法精确定位要删除的文件。
  - 只有“废弃(软删除)”接口，没有“物理删除 JSON 文件”的接口。
- 记忆文件落在 `server/memories/*.json`（见 [memoryFileService.js](file:///Users/mac/Documents/cxq/工作/ProjectMind/server/services/memoryFileService.js#L6-L8)）。

## 目标
- 在前端提供一个“记忆管理”可视化面板：
  - 列表查看当前 `server/memories` 中的记忆文件
  - 支持搜索/筛选
  - 支持废弃(软删)与物理删除(删文件)
  - 支持查看单条记忆详情（至少能看到 content/snippet/元信息）
- App.vue 中新增入口并抽出独立组件实现（不再把逻辑堆在 App.vue）。

## 后端改造（新增安全的文件级接口）
### 1) memoryFileService 新增“文件级读/列/删”能力
- 新增导出函数：
  - `loadDocumentedMemoryFiles({ includeDeprecated })`：返回数组 `[{ id: fileName, file: fileName, memory: normalizeMemory(mem) }]`，可选包含 deprecated。
  - `readMemoryFile(id)`：按文件名读取并返回 `{ file, memory }`。
  - `deleteMemoryFile(id)`：物理删除 `server/memories/<id>`。
- 安全约束：
  - `id` 必须是目录下的 `.json` 文件名，禁止包含路径分隔符、禁止 `..`、禁止以 `.` 开头，避免目录穿越。

### 2) routes/memories.js 新增 2-3 个 API
- `GET /api/memories/files?includeDeprecated=1`：返回 `{ memories: [...] }`（用于管理列表）。
- `GET /api/memories/get?id=<file>`：返回 `{ memory, file }`（用于详情查看，避免列表一次性拉大字段也行）。
- `POST /api/memories/delete`：body `{ id }`，物理删除文件。
  - 保留现有 `POST /deprecate` 作为“软删除”。

## 前端实现（新增独立组件 + App.vue 入口）
### 1) 新增 MemoryManager.vue 组件
- 路径：`frontend/src/components/MemoryManager.vue`
- 功能：
  - 顶部工具条：刷新、搜索框、includeDeprecated 开关
  - 列表：显示 file(id)、skill、toolName/type、snippet、updatedAt/createdAt
  - 操作：查看详情、废弃、删除（删除前二次确认）
  - 状态：loading/error/空态

### 2) 新增 useMemoryAdmin composable
- 路径：`frontend/src/composables/useMemoryAdmin.js`
- 封装：listFiles/get/delete/deprecate 请求与状态管理（baseUrl 与现有 `useSkills/useModels/useAgentStream` 一致）。

### 3) 在 App.vue 增加记忆管理入口并挂载组件
- 在 App.vue 增加 `showMemoryManager` 状态。
- UI 方案（二选一，我会选更顺手的 A）：
  - A：在 ChatHeader 增加一个“记忆”按钮，点击打开右侧抽屉/弹层（MemoryManager）
  - B：在 main 区域加一个小按钮/快捷入口打开面板
- MemoryManager 作为独立组件维护 UI 与逻辑，App.vue 只负责开关与布局。

## 验证
- 前端：`npm run build`。
- 手动链路：
  - 打开记忆管理面板 → 能看到文件列表
  - 删除/废弃后刷新列表，确认文件数量/状态变化
  - 随机打开详情确认内容一致

## 交付文件清单
- 后端：
  - `server/services/memoryFileService.js`（新增 list/get/delete 函数）
  - `server/routes/memories.js`（新增 /files /get /delete 路由）
- 前端：
  - `frontend/src/components/MemoryManager.vue`
  - `frontend/src/composables/useMemoryAdmin.js`
  - `frontend/src/App.vue`（新增入口 + 挂载）
  - （若选方案 A）`frontend/src/components/ChatHeader.vue`（增加“记忆”按钮 emit）