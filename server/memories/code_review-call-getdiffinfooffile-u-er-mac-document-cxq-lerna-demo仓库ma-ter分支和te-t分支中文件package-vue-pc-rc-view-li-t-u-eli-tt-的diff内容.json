{
  "toolName": "call",
  "type": "call",
  "content": "{\n  \"filename\": \"packages/vue-pc/src/views/list/useList.ts\",\n  \"content\": \"diff --git a/packages/vue-pc/src/views/list/useList.ts b/packages/vue-pc/src/views/list/useList.ts\\nnew file mode 100644\\nindex 0000000..b1b3eb0\\n--- /dev/null\\n+++ b/packages/vue-pc/src/views/list/useList.ts\\n@@ -0,0 +1,100 @@\\n+import { ref, reactive } from 'vue'\\n+import { message } from 'ant-design-vue'\\n+import { listMaterials, removeMaterial, removeMaterials, type MaterialRecord, type SearchFormData } from './service'\\n+\\n+export function useList() {\\n+  const loading = ref(false)\\n+  const tableData = ref<MaterialRecord[]>([])\\n+  const selectedRowKeys = ref<string[]>([])\\n+  const searchParams = reactive<SearchFormData>({})\\n+  const pagination = reactive({ current: 1, pageSize: 10, total: 0 })\\n+\\n+  async function fetchData() {\\n+    loading.value = true\\n+    try {\\n+      const res = await listMaterials({ page: pagination.current, pageSize: pagination.pageSize, search: searchParams })\\n+      tableData.value = res.rows\\n+      pagination.total = res.total\\n+    } catch {\\n+      message.error('获取数据失败')\\n+    } finally {\\n+      loading.value = false\\n+    }\\n+  }\\n+\\n+  function handleSearch(params: SearchFormData) {\\n+    Object.assign(searchParams, params)\\n+    pagination.current = 1\\n+    fetchData()\\n+  }\\n+\\n+  function handleReset() {\\n+    Object.keys(searchParams).forEach(k => delete (searchParams as any)[k])\\n+    pagination.current = 1\\n+    fetchData()\\n+  }\\n+\\n+  function handlePageChange(page: number, pageSize: number) {\\n+    pagination.current = page\\n+    pagination.pageSize = pageSize\\n+    fetchData()\\n+  }\\n+\\n+  function handleSelectionChange(keys: string[]) {\\n+    selectedRowKeys.value = keys\\n+  }\\n+\\n+  function clearSelection() {\\n+    selectedRowKeys.value = []\\n+  }\\n+\\n+  function handleAdd(open: (status: 'add', data?: MaterialRecord) => void) {\\n+    open('add')\\n+  }\\n+\\n+  function handleEdit(record: MaterialRecord, open: (status: 'edit', data?: MaterialRecord) => void) {\\n+    open('edit', record)\\n+  }\\n+\\n+  async function handleDelete(record: MaterialRecord) {\\n+    await removeMaterial(record.id)\\n+    message.success(`删除成功: ${record.materialName}`)\\n+    fetchData()\\n+  }\\n+\\n+  async function handleBatchDelete() {\\n+    if (!selectedRowKeys.value.length) return\\n+    await removeMaterials(selectedRowKeys.value)\\n+    message.success(`批量删除 ${selectedRowKeys.value.length} 项`)\\n+    selectedRowKeys.value = []\\n+    fetchData()\\n+  }\\n+\\n+  function handleExport() {\\n+    message.info('导出功能')\\n+  }\\n+\\n+  function handleBatchExport() {\\n+    message.info(`批量导出 ${selectedRowKeys.value.length} 项`)\\n+  }\\n+\\n+  return {\\n+    loading,\\n+    tableData,\\n+    selectedRowKeys,\\n+    searchParams,\\n+    pagination,\\n+    fetchData,\\n+    handleSearch,\\n+    handleReset,\\n+    handlePageChange,\\n+    handleSelectionChange,\\n+    clearSelection,\\n+    handleAdd,\\n+    handleEdit,\\n+    handleDelete,\\n+    handleBatchDelete,\\n+    handleExport,\\n+    handleBatchExport,\\n+  }\\n+}\",\n  \"originalContent\": \"\",\n  \"newContent\": \"import { ref, reactive } from 'vue'\\nimport { message } from 'ant-design-vue'\\nimport { listMaterials, removeMaterial, removeMaterials, type MaterialRecord, type SearchFormData } from './service'\\n\\nexport function useList() {\\n  const loading = ref(false)\\n  const tableData = ref<MaterialRecord[]>([])\\n  const selectedRowKeys = ref<string[]>([])\\n  const searchParams = reactive<SearchFormData>({})\\n  const pagination = reactive({ current: 1, pageSize: 10, total: 0 })\\n\\n  async function fetchData() {\\n    loading.value = true\\n    try {\\n      const res = await listMaterials({ page: pagination.current, pageSize: pagination.pageSize, search: searchParams })\\n      tableData.value = res.rows\\n      pagination.total = res.total\\n    } catch {\\n      message.error('获取数据失败')\\n    } finally {\\n      loading.value = false\\n    }\\n  }\\n\\n  function handleSearch(params: SearchFormData) {\\n    Object.assign(searchParams, params)\\n    pagination.current = 1\\n    fetchData()\\n  }\\n\\n  function handleReset() {\\n    Object.keys(searchParams).forEach(k => delete (searchParams as any)[k])\\n    pagination.current = 1\\n    fetchData()\\n  }\\n\\n  function handlePageChange(page: number, pageSize: number) {\\n    pagination.current = page\\n    pagination.pageSize = pageSize\\n    fetchData()\\n  }\\n\\n  function handleSelectionChange(keys: string[]) {\\n    selectedRowKeys.value = keys\\n  }\\n\\n  function clearSelection() {\\n    selectedRowKeys.value = []\\n  }\\n\\n  function handleAdd(open: (status: 'add', data?: MaterialRecord) => void) {\\n    open('add')\\n  }\\n\\n  function handleEdit(record: MaterialRecord, open: (status: 'edit', data?: MaterialRecord) => void) {\\n    open('edit', record)\\n  }\\n\\n  async function handleDelete(record: MaterialRecord) {\\n    await removeMaterial(record.id)\\n    message.success(`删除成功: ${record.materialName}`)\\n    fetchData()\\n  }\\n\\n  async function handleBatchDelete() {\\n    if (!selectedRowKeys.value.length) return\\n    await removeMaterials(selectedRowKeys.value)\\n    message.success(`批量删除 ${selectedRowKeys.value.length} 项`)\\n    selectedRowKeys.value = []\\n    fetchData()\\n  }\\n\\n  function handleExport() {\\n    message.info('导出功能')\\n  }\\n\\n  function handleBatchExport() {\\n    message.info(`批量导出 ${selectedRowKeys.value.length} 项`)\\n  }\\n\\n  return {\\n    loading,\\n    tableData,\\n    selectedRowKeys,\\n    searchParams,\\n    pagination,\\n    fetchData,\\n    handleSearch,\\n    handleReset,\\n    handlePageChange,\\n    handleSelectionChange,\\n    clearSelection,\\n    handleAdd,\\n    handleEdit,\\n    handleDelete,\\n    handleBatchDelete,\\n    handleExport,\\n    handleBatchExport,\\n  }\\n}\",\n  \"stats\": {\n    \"additions\": 100,\n    \"deletions\": 0,\n    \"status\": \"added\"\n  },\n  \"summary\": {\n    \"additions\": 100,\n    \"deletions\": 0,\n    \"totalChanges\": 100,\n    \"status\": \"added\"\n  },\n  \"desc\": \"/Users/mac/Documents/cxq/lerna-demo 仓库 master 分支和 test 分支中文件 packages/vue-pc/src/views/list/useList.ts 的 diff 内容\"\n}",
  "snippet": "/Users/mac/Documents/cxq/lerna-demo 仓库 master 分支和 test 分支中文件 packages/vue-pc/src/views/list/useList.ts 的 diff 内容",
  "skill": "code_review",
  "skillDescription": "",
  "script": "scripts/getDiffinfoOfFile.js",
  "createdAt": 1768533449426,
  "updatedAt": 1768533449426,
  "meta": {
    "name": "",
    "description": "",
    "type": "object",
    "desc": "/Users/mac/Documents/cxq/lerna-demo 仓库 master 分支和 test 分支中文件 packages/vue-pc/src/views/list/useList.ts 的 diff 内容"
  },
  "deprecated": false
}